<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>

<mapper namespace="com.back.admin.dao.AdminTeamDAO">

	<select id="totalPage" resultType="int">
		SELECT COUNT(team_idx)
		FROM team
		<choose>
			<when test='searchFlag == "true" and searchCategory == "teamName"' >
				where team_name like CONCAT('%', #{searchWord} ,'%')
			</when>
			<when test='searchFlag == "true" and searchCategory == "teamAddress"' >
				where team_address like CONCAT('%', #{searchWord} ,'%')
			</when>
		</choose>
	</select>

	<select id="list" resultType="com.back.admin.dto.AdminTeamDTO">
		SELECT 
			logo
			, team_name 
			, team_address 
			, id 
			, team_idx 
		from team
		<choose>
			<when test='searchFlag == "true" and searchCategory == "teamName"' >
				where team_name like CONCAT('%', #{searchWord} ,'%')
			</when>
			<when test='searchFlag == "true" and searchCategory == "teamAddress"' >
				where team_address like CONCAT('%', #{searchWord} ,'%')
			</when>
		</choose>
		limit #{start},10
	</select>
	
	
	
	<select id="teamInfo" resultType="com.back.admin.dto.AdminTeamDTO">
		SELECT
			logo 
			,team_name 
			,team_level 
			,team_address 
			,team_info 
			,team_idx 
			,id
		FROM team  
		where team_idx = #{param1}	
	</select>
	
	<select id="teammateList" resultType="com.back.admin.dto.AdminTeamDTO">
		SELECT 
			tl.id 
			, CASE 
			when tl.id = t.id then '팀장'
			else '팀원'
			end as teamjang
		FROM team t 
		join team_list tl 
		on t.team_idx = tl.team_idx 
		where t.team_idx = #{param1}
		order by teamjang desc
		LIMIT #{param2},10
	</select>
	
	<select id="teammateTotal" resultType="int">
		SELECT 
			COUNT(id) 
		FROM team_list tl
		where team_idx = #{param1}
	</select>
</mapper>


























